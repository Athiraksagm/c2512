cmake_minimum_required(VERSION 3.10)
project(SystemStatLogging)

set(CMAKE_CXX_STANDARD 14)
find_package(Boost REQUIRED)

# Add paths for the includes and libraries
include_directories(include)
link_directories(${CMAKE_SOURCE_DIR}/lib)
include_directories(${CMAKE_SOURCE_DIR}/include)

# Add GTest
find_package(GTest REQUIRED)
include_directories(${GTEST_INCLUDE_DIRS})

# Add the server and client executables
add_executable(server source/server.cpp)
add_executable(client source/client.cpp)

# Add the tests
add_executable(test_system_stats test/test_system_stats.cpp)
target_include_directories(test_system_stats PRIVATE ${TinyXML2_INCLUDE_DIRS})

# Link GTest with the tests
target_link_libraries(test_system_stats PRIVATE TinyXML2::TinyXML2 gtest gtest_main pthread)

# Link server and client with necessary libraries
target_link_libraries(server Boost::boost)
target_link_libraries(server pthread tinyxml2)
target_link_libraries(client pthread)
target_link_libraries(client Boost::boost)

# Install CMake files
install(TARGETS server client DESTINATION bin)
